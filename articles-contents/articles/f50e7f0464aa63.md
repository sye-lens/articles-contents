---
title: "ã€æ¯æ—¥ã®ç©ã¿ä¸Šã’æŠ•ç¨¿ã€‘Rails Tutorial 10.2.1"
emoji: "ğŸ’"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Ruby", "RubyonRails"]
published: true
---

# ç©ã¿ä¸Šã’æŠ•ç¨¿ã®ç›®çš„

1. æ¯æ—¥ã®å­¦ç¿’ã®ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆ
2. å­¦ç¿’ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®ä½¿ã„æ–¹ã‚’è‡ªè¦šã—ãªãŒã‚‰é€²ã‚ã‚‹ãŸã‚
3. æŠ€è¡“è¨˜äº‹æŠ•ç¨¿ã®ç¿’æ…£åŒ–
4. å­¦ç¿’->ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã‚’ç¿’æ…£ã«ã™ã‚‹è¨“ç·´

# æœ¬æ—¥ã®å­¦ç¿’ã®ç›®çš„

- Rails ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§åŸºæœ¬æ©Ÿèƒ½å®Ÿè£…ã®æ¦‚è¦³ã‚’æ´ã‚€
- ç†è§£ 5 å‰²ã§ã‚‚ OKã€‚ã¾ãšã¯åŸºæœ¬æ©Ÿèƒ½ã‚’å½¢ã ã‘ã§ã‚‚å®Ÿè£…ã§ãã‚‹ã“ã¨ãŒç›®çš„

# æœ¬æ—¥ã®å­¦ç¿’å†…å®¹ ã€Rails Tutorial 10.2.1 ã€€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ãƒ­ã‚°ã‚¤ãƒ³ã‚’è¦æ±‚ã™ã‚‹ã€‘

## ç¾çŠ¶

- ãƒ­ã‚°ã‚¤ãƒ³ï¼ˆlogin,create ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼‰æ©Ÿèƒ½ã®å®Ÿè£…å®Œäº†
- ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±æ›´æ–°ç·¨é›†ï¼ˆedit,update ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼‰ã®å®Ÿè£…å®Œäº†

## èª²é¡Œ

- ã©ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã§ã‚‚ã‚ã‚‰ã‚†ã‚‹ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹
  - '/users/1/edit'ã§ã€èª°ã§ã‚‚ user1 ã®æƒ…å ±ã‚’ç·¨é›†ãƒ»å‰Šé™¤ã§ãã¦ã—ã¾ã†

## è§£æ±ºç­–

- 'users_controller'ã« befere ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’å®Ÿè£…ã—ãŸ
- edit ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¨ update ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®å‰ã« logged_in_user ãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¿½åŠ ã—ãŸ

  ```ruby
  before_action :logged_in_user, only: [:edit, :update]
  .
  .
  .
  def logged_in_user
  unless logged_in?
  flash[:danger] = "Please log in."
  redirect_to login_url, status: :see_other
  end
  end
  ```

- çµ±åˆãƒ†ã‚¹ãƒˆã« log_in_as ãƒ˜ãƒ«ãƒ‘ãƒ¼ã‚’ä½¿ç”¨ã—ã¦ãƒ­ã‚°ã‚¤ãƒ³ã‚’è¨˜è¿°ã—ãŸ

  ```ruby
  test "unsuccessful edit" do
  log_in_as(@user)
  get edit_user_path(@user)
  .
  .
  .
  end

  test "successful edit" do
  log_in_as(@user)
  get edit_user_path(@user)
  .
  .
  .
  end
  ```

- Users ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã« edit ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆGET ãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼‰ã€update ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆPATCH ãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼‰ã‚’å®Ÿè¡Œã—ãŸéš›ã®ãƒ†ã‚¹ãƒˆã‚’å®Ÿè£…ã—ãŸ

  ```ruby
  def setup
  @user = users(:michael)
  end
  .
  .
  .
  test "should redirect edit when not logged in" do
  get edit_user_path(@user)
  assert_not flash.empty?
  assert_redirected_to login_url
  end

  test "should redirect update when not logged in" do
  patch user_path(@user), params: { user: { name: @user.name,
  email: @user.email } }
  assert_not flash.empty?
  assert_redirected_to login_url
  ```

## ç–‘å•ç‚¹

- status :see_other ã¨ã¯ä½•ã‹ï¼Ÿ
- controller ã«å¯¾ã™ã‚‹ãƒ†ã‚¹ãƒˆã¨ã€integration ãƒ†ã‚¹ãƒˆã®é•ã„ã¨ã¯ï¼Ÿ
